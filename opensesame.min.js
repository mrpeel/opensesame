var PassOff=function(){"use strict";this.keyNS="cake.man.passoff",this.passwordNS="cake.man.passoff.password",this.loginNS="cake.man.passoff.login",this.answerNS="cake.man.passoff.answer",this.fullName="",this.passPhrase="",this.domainName="",this.userName="",this.securityQuestion="",this.templates={"maximum-password":["anoxxxxxxxxxxxxxxxxx","axxxxxxxxxxxxxxxxxno"],"long-password":["CvcvnoCvcvCvcv","CvcvCvcvnoCvcv","CvcvCvcvCvcvno","CvccnoCvcvCvcv","CvccCvcvnoCvcv","CvccCvcvCvcvno","CvcvnoCvccCvcv","CvcvCvccnoCvcv","CvcvCvccCvcvno","CvcvnoCvcvCvcc","CvcvCvcvnoCvcc","CvcvCvcvCvccno","CvccnoCvccCvcv","CvccCvccnoCvcv","CvccCvccCvcvno","CvcvnoCvccCvcc","CvcvCvccnoCvcc","CvcvCvccCvccno","CvccnoCvcvCvcc","CvccCvcvnoCvcc","CvccCvcvCvccno"],"medium-password":["CvcnoCvc","CvcCvcno"],"basic-password":["aaanaaan","aannaaan","aaannaaa"],"short-password":["Cvcn"],pin:["nnnn"],"pin-6":["nnnnnn"],login:["cvccvcvcv"],answer:["cvcc cvc cvccvcv cvc","cvc cvccvcvcv cvcv","cv cvccv cvc cvcvccv"]},this.passchars={V:"AEIOU",C:"BCDFGHJKLMNPQRSTVWXYZ",v:"aeiou",c:"bcdfghjklmnpqrstvwxyz",A:"AEIOUBCDFGHJKLMNPQRSTVWXYZ",a:"AEIOUaeiouBCDFGHJKLMNPQRSTVWXYZbcdfghjklmnpqrstvwxyz",n:"0123456789",o:"@&%?,=[]_:-+*$#!'^~;()/.",x:"AEIOUaeiouBCDFGHJKLMNPQRSTVWXYZbcdfghjklmnpqrstvwxyz0123456789!@#$%^&*()"," ":" "},this.countryTLDs=["ac","ad","ae","af","ag","ai","al","am","an","ao","aq","ar","as","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","bj","bm","bn","bo","br","bs","bt","bv","bw","by","bz","ca","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","cr","cs","cu","cv","cw","cx","cy","cz","dd","de","dj","dk","dm","do","dz","ec","ee","eg","eh","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","iq","ir","is","it","je","jm","jo","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mk","ml","mm","mn","mo","mp","mq","mr","ms","mt","mu","mv","mw","mx","my","mz","na","nc","ne","nf","ng","ni","nl","no","np","nr","nu","nz","om","pa","pe","pf","pg","ph","pk","pl","pm","pn","pr","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tf","tg","th","tj","tk","tl","tm","tn","to","tp","tr","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","ye","yt","yu","za","zm","zw"]};PassOff.prototype.PBKDF2=function(e,s){"use strict";return new Promise(function(a,t){var o=CryptoJS.PBKDF2(e,s,{iterations:750,keySize:4});a(o)})},PassOff.prototype.HMACSHA256=function(e,s){"use strict";return new Promise(function(a,t){var o=CryptoJS.HmacSHA256(e,s);a(o)})},PassOff.prototype.convertWordArrayToUint8Array=function(e){"use strict";var o,r,s=e.words.length,a=new Uint8Array(s<<2),t=0;for(r=0;s>r;r++)o=e.words[r],a[t++]=o>>24,a[t++]=o>>16&255,a[t++]=o>>8&255,a[t++]=255&o;return a},PassOff.prototype.clearPassPhrase=function(e){"use strict";this.passPhrase="00000000000000000000000000000000000000000000000000000000000000000000000000000",this.passPhrase=""},PassOff.prototype.generatePassword=function(e){"use strict";var a;performance.now();if(0===this.fullName.length)return Promise.reject(new Error("Name not present"));if(0===this.passPhrase.length)return Promise.reject(new Error("Passphrase not present"));if(0===this.domainName.length)return Promise.reject(new Error("Domain name not present"));if("answer"===e&&0===this.securityQuestion.length)return Promise.reject(new Error("Security question not present"));try{var t=this;return new Promise(function(s,o){a=t.passwordNS,"answer"===e?a=t.answerNS:"login"==e&&(a=t.loginNS);var u,r=t.fullName.trim().toLowerCase(),n=a+"."+r,d=t.userName.trim().toLowerCase(),i=0,l="",c=t.domainName.replace(/^https?:\/\//g,"").toLowerCase();i=c.indexOf("/"),i>0&&(c=c.substr(0,i)),u=c.split("."),u.length>1&&t.countryTLDs.indexOf(u[u.length-1])>=0&&(l="."+u[u.length-1],u=u.slice(0,-1)),u.length>2&&(u=u.slice(-2)),c=u.join(".")+l;var m="";return d&&d.length>0&&(c=d+"@"+c),"answer"===e&&(m=t.securityQuestion.replace(/[.,-\/#!$%\^&\*;:{}=\-_`~()?'"]/g,"").replace(/  +/g," ").trim().toLowerCase(),c=c+":"+m),t.PBKDF2(t.passPhrase,n).then(function(e){return t.HMACSHA256(c,e)}).then(function(e){var s=t.convertWordArrayToUint8Array(e);return s}).then(function(a){for(var o=t.templates[e],r=o[a[0]%o.length],n=r.split("").map(function(e,s){var o=t.passchars[e];return o[a[s+1]%o.length]}).join(""),d=0;d<a.length;d++)a[d]=0;t.clearPassPhrase(),s(n)})["catch"](function(e){return Promise.reject(e)})})}catch(o){return Promise.reject(o)}};