var PassOff=function(){"use strict";this.keyNS="cake.man.passoff",this.passwordNS="cake.man.passoff.password",this.loginNS="cake.man.passoff.login",this.answerNS="cake.man.passoff.answer",this.fullName="",this.passPhrase="",this.domainName="",this.userName="",this.securityQuestion="",this.templates={"maximum-password":["anoxxxxxxxxxxxxxxxxx","axxxxxxxxxxxxxxxxxno"],"long-password":["CvcvnoCvcvCvcv","CvcvCvcvnoCvcv","CvcvCvcvCvcvno","CvccnoCvcvCvcv","CvccCvcvnoCvcv","CvccCvcvCvcvno","CvcvnoCvccCvcv","CvcvCvccnoCvcv","CvcvCvccCvcvno","CvcvnoCvcvCvcc","CvcvCvcvnoCvcc","CvcvCvcvCvccno","CvccnoCvccCvcv","CvccCvccnoCvcv","CvccCvccCvcvno","CvcvnoCvccCvcc","CvcvCvccnoCvcc","CvcvCvccCvccno","CvccnoCvcvCvcc","CvccCvcvnoCvcc","CvccCvcvCvccno"],"medium-password":["CvcnoCvc","CvcCvcno"],"basic-password":["aaanaaan","aannaaan","aaannaaa"],"short-password":["Cvcn"],pin:["nnnn"],"pin-6":["nnnnnn"],login:["cvccvcvcv"],answer:["cvcc cvc cvccvcv cvc","cvc cvccvcvcv cvcv","cv cvccv cvc cvcvccv"]},this.passchars={V:"AEIOU",C:"BCDFGHJKLMNPQRSTVWXYZ",v:"aeiou",c:"bcdfghjklmnpqrstvwxyz",A:"AEIOUBCDFGHJKLMNPQRSTVWXYZ",a:"AEIOUaeiouBCDFGHJKLMNPQRSTVWXYZbcdfghjklmnpqrstvwxyz",n:"0123456789",o:"@&%?,=[]_:-+*$#!'^~;()/.",x:"AEIOUaeiouBCDFGHJKLMNPQRSTVWXYZbcdfghjklmnpqrstvwxyz0123456789!@#$%^&*()"," ":" "}};PassOff.prototype.PBKDF2=function(e,s){"use strict";return new Promise(function(a,t){var o=CryptoJS.PBKDF2(e,s,{iterations:750,keySize:4});a(o)})},PassOff.prototype.HMACSHA256=function(e,s){"use strict";return new Promise(function(a,t){var o=CryptoJS.HmacSHA256(e,s);a(o)})},PassOff.prototype.convertWordArrayToUint8Array=function(e){"use strict";var o,r,s=e.words.length,a=new Uint8Array(s<<2),t=0;for(r=0;s>r;r++)o=e.words[r],a[t++]=o>>24,a[t++]=o>>16&255,a[t++]=o>>8&255,a[t++]=255&o;return a},PassOff.prototype.generatePassword=function(e){"use strict";var a;performance.now();if(0===this.fullName.length)return Promise.reject(new Error("Name not present"));if(0===this.passPhrase.length)return Promise.reject(new Error("Passphrase not present"));if(0===this.domainName.length)return Promise.reject(new Error("Domain name not present"));if("answer"===e&&0===this.securityQuestion.length)return Promise.reject(new Error("Security question not present"));try{var t=this;return new Promise(function(s,o){a=t.passwordNS,"answer"===e?a=t.answerNS:"login"==e&&(a=t.loginNS);var r=t.fullName.trim().toLowerCase(),n=a+"."+r,i=t.userName.trim().toLowerCase(),d=0,u=t.domainName.replace("https://","").replace("http://","").replace(/^www[\w-]*./g,"").trim().toLowerCase();d=u.indexOf("/"),d>0&&(u=u.substr(0,d));var m="";return i&&i.length>0&&(u=i+"@"+u),"answer"===e&&(m=t.securityQuestion.replace(/[.,-\/#!$%\^&\*;:{}=\-_`~()?'"]/g,"").replace(/  +/g," ").trim().toLowerCase(),u=u+":"+m),t.PBKDF2(t.passPhrase,n).then(function(e){return t.HMACSHA256(u,e)}).then(function(e){var s=t.convertWordArrayToUint8Array(e);return s}).then(function(a){var o=t.templates[e],r=o[a[0]%o.length],n=r.split("").map(function(e,s){var o=t.passchars[e];return o[a[s+1]%o.length]}).join("");s(n)})["catch"](function(e){return Promise.reject(e)})})}catch(o){return Promise.reject(o)}};