var PassOff=function(){"use strict";this.keyNS="cake.man.passoff",this.passwordNS="cake.man.passoff.password",this.loginNS="cake.man.passoff.login",this.answerNS="cake.man.passoff.answer",this.fullName="",this.passPhrase="",this.domainName="",this.userName="",this.securityQuestion="",this.templates={"maximum-password":["anoxxxxxxxxxxxxxxxxx","axxxxxxxxxxxxxxxxxno"],"long-password":["CvcvnoCvcvCvcv","CvcvCvcvnoCvcv","CvcvCvcvCvcvno","CvccnoCvcvCvcv","CvccCvcvnoCvcv","CvccCvcvCvcvno","CvcvnoCvccCvcv","CvcvCvccnoCvcv","CvcvCvccCvcvno","CvcvnoCvcvCvcc","CvcvCvcvnoCvcc","CvcvCvcvCvccno","CvccnoCvccCvcv","CvccCvccnoCvcv","CvccCvccCvcvno","CvcvnoCvccCvcc","CvcvCvccnoCvcc","CvcvCvccCvccno","CvccnoCvcvCvcc","CvccCvcvnoCvcc","CvccCvcvCvccno"],"medium-password":["CvcnoCvc","CvcCvcno"],"basic-password":["aaanaaan","aannaaan","aaannaaa"],"short-password":["Cvcn"],pin:["nnnn"],"pin-6":["nnnnnn"],login:["cvccvcvcv"],answer:["cvcc cvc cvccvcv cvc","cvc cvccvcvcv cvcv","cv cvccv cvc cvcvccv"]},this.passchars={V:"AEIOU",C:"BCDFGHJKLMNPQRSTVWXYZ",v:"aeiou",c:"bcdfghjklmnpqrstvwxyz",A:"AEIOUBCDFGHJKLMNPQRSTVWXYZ",a:"AEIOUaeiouBCDFGHJKLMNPQRSTVWXYZbcdfghjklmnpqrstvwxyz",n:"0123456789",o:"@&%?,=[]_:-+*$#!'^~;()/.",x:"AEIOUaeiouBCDFGHJKLMNPQRSTVWXYZbcdfghjklmnpqrstvwxyz0123456789!@#$%^&*()"," ":" "}};PassOff.prototype.PBKDF2=function(c,r){"use strict";return new Promise(function(n,v){var e=CryptoJS.PBKDF2(c,r,{iterations:750,keySize:4});n(e)})},PassOff.prototype.HMACSHA256=function(c,r){"use strict";return new Promise(function(n,v){var e=CryptoJS.HmacSHA256(c,r);n(e)})},PassOff.prototype.convertWordArrayToUint8Array=function(c){"use strict";var e,t,r=c.words.length,n=new Uint8Array(r<<2),v=0;for(t=0;r>t;t++)e=c.words[t],n[v++]=e>>24,n[v++]=e>>16&255,n[v++]=e>>8&255,n[v++]=255&e;return n},PassOff.prototype.generatePassword=function(c){"use strict";var n;performance.now();if(0===this.fullName.length)return Promise.reject(new Error("Name not present"));if(0===this.passPhrase.length)return Promise.reject(new Error("Passphrase not present"));if(0===this.domainName.length)return Promise.reject(new Error("Domain name not present"));if("answer"===c&&0===this.securityQuestion.length)return Promise.reject(new Error("Security question not present"));try{var v=this;return new Promise(function(r,e){n=v.passwordNS,"answer"===c?n=v.answerNS:"login"==c&&(n=v.loginNS);var t=v.fullName.trim().toLowerCase(),s=n+"."+t,a=v.userName.trim().toLowerCase(),o=0,i=v.domainName.replace("https://","").replace("http://","").replace(/^www[\w-]*./g,"").trim().toLowerCase();o=i.indexOf("/"),o>0&&(i=i.substr(0,o));var C="";return a&&a.length>0&&(i=a+"@"+i),"answer"===c&&(C=v.securityQuestion.replace(/[.,-\/#!$%\^&\*;:{}=\-_`~()?'"]/g,"").replace(/  +/g," ").trim().toLowerCase(),i=i+":"+C),v.PBKDF2(v.passPhrase,s).then(function(c){return v.HMACSHA256(i,c)}).then(function(c){var r=v.convertWordArrayToUint8Array(c);return r}).then(function(n){var e=v.templates[c],t=e[n[0]%e.length],s=t.split("").map(function(c,r){var e=v.passchars[c];return e[n[r+1]%e.length]}).join("");r(s)})["catch"](function(c){return Promise.reject(c)})})}catch(e){return Promise.reject(e)}};