describe("Test Open Sesame Missing Parameter Rejection",function(){var e=new PassOff,a="maximum-password";beforeEach(JasminePromiseMatchers.install),it("should fail with no parameters specified",function(s){expect(e.generatePassword(a)).toBeRejected(s)}),it("should fail with no name specified",function(s){e.passPhrase="My pass phrase",e.domainName="test.com",e.securityQuestion="why",expect(e.generatePassword(a)).toBeRejected(s)}),it("should fail with no pass phrase specified",function(s){e.fullName="JaneCitizen",e.passPhrase="",e.domainName="test.com",e.securityQuestion="why",expect(e.generatePassword(a)).toBeRejected(s)}),it("should fail with no domain specified",function(s){e.fullName="JaneCitizen",e.passPhrase="My pass phrase",e.domainName="",e.securityQuestion="why",expect(e.generatePassword(a)).toBeRejected(s)}),it("answer type should fail with no question specified",function(a){e.fullName="JaneCitizen",e.passPhrase="My pass phrase",e.domainName="test.com",e.securityQuestion="",expect(e.generatePassword("answer")).toBeRejected(a)}),afterEach(JasminePromiseMatchers.uninstall)}),describe("Test Maximum Passwords",function(){var e=new PassOff,a="h8_PBg0(ikEXvA93@mPC",s="K7*Zf3$ke44hn%y)F8oi",t="maximum-password",n="JaneCitizen",o="jcitizen",r="My pass phrase",i="test.com";beforeEach(JasminePromiseMatchers.install),it("should generate known password",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for name",function(s){e.fullName=n.toUpperCase(),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for user name",function(s){e.fullName=n,e.userName=o.toUpperCase(),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for domain",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain starts with 'www.'",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="www."+i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain has full URL",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="https://www."+i+"/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate a different password when case is changed for pass phrase",function(a){e.fullName=n,e.userName=o,e.passPhrase=r.toLowerCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("i2?WPugak9Cmu&FkJXA@",a)}),it("should generate a different password when full name is changed",function(a){e.fullName=n.substring(1),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("f%hW1TBYaZQsRS9Vj@1=",a)}),it("should generate a different password when user name is changed",function(a){e.fullName=n,e.userName=o.substring(2),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("MBaLdIZZQ!BCURcIno2?",a)}),it("should generate a different password when domain is changed",function(a){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.substring(3),expect(e.generatePassword(t)).toBeResolvedWith("W02ixFIwZIA0uvPDSM1%",a)}),it("should generate known password without a user name",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when case is changed for name",function(a){e.fullName=n.toLowerCase(),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when case is changed for domain",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain starts with 'www.'",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="www."+i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain has full URL",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="http://www."+i+"/intothebowels/downthere/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate a different password when case is changed for pass phrase",function(a){e.fullName=n,e.userName="",e.passPhrase=r.toUpperCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("fjS*iSzTPQXlCBtM601;",a)}),it("should generate a different password when full name is changed",function(a){e.fullName=n.substring(4),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("dp#o7BBPRIRv#TgucM7_",a)}),it("should generate a different password when domain is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.substring(1),expect(e.generatePassword(t)).toBeResolvedWith("cIF0Ge^jaIJC8sBFr41&",a)}),afterEach(JasminePromiseMatchers.uninstall)}),describe("Test Long Passwords",function(){var e=new PassOff,a="JukuBacqMawu0_",s="Yusa1-JuroWuds",t="long-password",n="JimiHendrix",o="jmhendrix",r="I see you down on the street, oh foxy",i="hendrix.com.au";beforeEach(JasminePromiseMatchers.install),it("should generate known password",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for name",function(s){e.fullName=n.toUpperCase(),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for user name",function(s){e.fullName=n,e.userName=o.toUpperCase(),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for domain",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain starts with 'mail.'",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="mail."+i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain has full URL",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="https://mail."+i+"/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate a different password when case is changed for pass phrase",function(a){e.fullName=n,e.userName=o,e.passPhrase=r.toLowerCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("Bopy3?WajnTado",a)}),it("should generate a different password when full name is changed",function(a){e.fullName=n.substring(1),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("Qale1[CucuZiqb",a)}),it("should generate a different password when user name is changed",function(a){e.fullName=n,e.userName=o.substring(2),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("CujeXeylMelz2;",a)}),it("should generate a different password when domain is changed",function(a){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.substring(3),expect(e.generatePassword(t)).toBeResolvedWith("HobnBahlGega4,",a)}),it("should generate known password without a user name",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when case is changed for name",function(a){e.fullName=n.toLowerCase(),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when case is changed for domain",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain starts with 'mail.'",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="mail."+i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain has full URL",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="http://mail."+i+"/intothebowels/downthere/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate a different password when case is changed for pass phrase",function(a){e.fullName=n,e.userName="",e.passPhrase=r.toUpperCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("FihaGiju3;Toci",a)}),it("should generate a different password when full name is changed",function(a){e.fullName=n.substring(4),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("YoloMasiPoqa2[",a)}),it("should generate a different password when domain is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.substring(1),expect(e.generatePassword(t)).toBeResolvedWith("Gixo1!XopbYubq",a)}),afterEach(JasminePromiseMatchers.uninstall)}),describe("Test Medium Passwords",function(){var e=new PassOff,a="HayXuj4$",s="Yun5%Mux",t="medium-password",n="JohnKennedy",o="jfk",r="Ask not wht Pass Off can do for you",i="grassyknoll.co.nz";beforeEach(JasminePromiseMatchers.install),it("should generate known password",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for name",function(s){e.fullName=n.toUpperCase(),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for user name",function(s){e.fullName=n,e.userName=o.toUpperCase(),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for domain",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain starts with 'double.barell.'",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="double.barell."+i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain has full URL",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="https://double.barell."+i+"/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate a different password when case is changed for pass phrase",function(a){e.fullName=n,e.userName=o,e.passPhrase=r.toLowerCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("Yeq5&Tul",a)}),it("should generate a different password when full name is changed",function(a){e.fullName=n.substring(1),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("Haj8=Nun",a)}),it("should generate a different password when user name is changed",function(a){e.fullName=n,e.userName=o.substring(2),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("QisHac6'",a)}),it("should generate a different password when domain is changed",function(a){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.substring(3),expect(e.generatePassword(t)).toBeResolvedWith("Mer9(Zic",a)}),it("should generate known password without a user name",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when case is changed for name",function(a){e.fullName=n.toLowerCase(),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when case is changed for domain",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain starts with 'double.barell.'",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="double.barell."+i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain has full URL",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="http://double.barell."+i+"/intothebowels/downthere/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate a different password when case is changed for pass phrase",function(a){e.fullName=n,e.userName="",e.passPhrase=r.toUpperCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("KuhSat3.",a)}),it("should generate a different password when full name is changed",function(a){e.fullName=n.substring(4),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("Was8%Zec",a)}),it("should generate a different password when domain is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.substring(1),expect(e.generatePassword(t)).toBeResolvedWith("NerFol8?",a)}),afterEach(JasminePromiseMatchers.uninstall)}),describe("Test Basic Passwords",function(){var e=new PassOff,a="iMr42cpW",s="Gd11gls8",t="basic-password",n="BobMarley",o="bobm",r="Get up Stand Up",i="bobmarley.org.tw";beforeEach(JasminePromiseMatchers.install),it("should generate known password",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for name",function(s){e.fullName=n.toUpperCase(),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for user name",function(s){e.fullName=n,e.userName=o.toUpperCase(),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for domain",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain starts with 'accounts.'",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="accounts."+i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain has full URL",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="https://accounts."+i+"/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate a different password when case is changed for pass phrase",function(a){e.fullName=n,e.userName=o,e.passPhrase=r.toLowerCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("pR15qGC2",a)}),it("should generate a different password when full name is changed",function(a){e.fullName=n.substring(1),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("maw6yDE2",a)}),it("should generate a different password when user name is changed",function(a){e.fullName=n,e.userName=o.substring(2),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("Qp67wNf0",a)}),it("should generate a different password when domain is changed",function(a){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.substring(3),expect(e.generatePassword(t)).toBeResolvedWith("Msm77bDg",a)}),it("should generate known password without a user name",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when case is changed for name",function(a){e.fullName=n.toLowerCase(),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when case is changed for domain",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain starts with 'accounts.'",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="accounts."+i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain has full URL",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="http://accounts."+i+"/intothebowels/downthere/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate a different password when case is changed for pass phrase",function(a){e.fullName=n,e.userName="",e.passPhrase=r.toUpperCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("ls19hhn3",a)}),it("should generate a different password when full name is changed",function(a){e.fullName=n.substring(4),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("OME4cLd9",a)}),it("should generate a different password when domain is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.substring(1),expect(e.generatePassword(t)).toBeResolvedWith("dy40iwK2",a)}),afterEach(JasminePromiseMatchers.uninstall)}),describe("Test Short Passwords",function(){var e=new PassOff,a="Tob1",s="Kej5",t="short-password",n="Quantic",o="quantic",r="Infinite rwgression",i="soulorchestra.io";beforeEach(JasminePromiseMatchers.install),it("should generate known password",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for name",function(s){e.fullName=n.toUpperCase(),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for user name",function(s){e.fullName=n,e.userName=o.toUpperCase(),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when case is changed for domain",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain starts with 'login.'",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="login."+i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain has full URL",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="https://login."+i+"/stuff/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate a different password when case is changed for pass phrase",function(a){e.fullName=n,e.userName=o,e.passPhrase=r.toLowerCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("Miv9",a)}),it("should generate a different password when full name is changed",function(a){e.fullName=n.substring(1),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("Jen9",a)}),it("should generate a different password when user name is changed",function(a){e.fullName=n,e.userName=o.substring(2),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("Lac8",a)}),it("should generate a different password when domain is changed",function(a){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.substring(3),expect(e.generatePassword(t)).toBeResolvedWith("Hut5",a)}),it("should generate known password without a user name",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when case is changed for name",function(a){e.fullName=n.toLowerCase(),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when case is changed for domain",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain starts with 'login.'",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="login."+i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain has full URL",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="http://login."+i+"/intothebowels/downthere/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate a different password when case is changed for pass phrase",function(a){e.fullName=n,e.userName="",e.passPhrase=r.toUpperCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("Gut4",a)}),it("should generate a different password when full name is changed",function(a){e.fullName=n.substring(4),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("Nac5",a)}),it("should generate a different password when domain is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.substring(1),expect(e.generatePassword(t)).toBeResolvedWith("Cap7",a)}),afterEach(JasminePromiseMatchers.uninstall)}),describe("Test Four Digit Pin",function(){var e=new PassOff,a="1759",s="6843",t="pin",n="TylerDurden",o="tdurden",r="The first rule of Pass Off is there is no Pass Off",i="fightclub.edu.ca";beforeEach(JasminePromiseMatchers.install),it("should generate known PIN",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same PIN when case is changed for name",function(s){e.fullName=n.toUpperCase(),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same PIN when case is changed for user name",function(s){e.fullName=n,e.userName=o.toUpperCase(),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same PIN when case is changed for domain",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same PIN when domain starts with 'www2.'",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="www2."+i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain has full URL",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="https://www2."+i+"/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate a different PIN when case is changed for pass phrase",function(a){e.fullName=n,e.userName=o,e.passPhrase=r.toLowerCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("6083",a)}),it("should generate a different PIN when full name is changed",function(a){e.fullName=n.substring(1),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("3611",a)}),it("should generate a different PIN when user name is changed",function(a){e.fullName=n,e.userName=o.substring(2),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("1898",a)}),it("should generate a different PIN when domain is changed",function(a){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.substring(3),expect(e.generatePassword(t)).toBeResolvedWith("0978",a)}),it("should generate known PIN without a user name",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same PIN when case is changed for name",function(a){e.fullName=n.toLowerCase(),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same PIN when case is changed for domain",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same PIN when domain starts with 'www2.'",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="www2."+i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain has full URL",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="http://www2."+i+"/intothebowels/downthere/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate a different PIN when case is changed for pass phrase",function(a){e.fullName=n,e.userName="",e.passPhrase=r.toUpperCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("8584",a)}),it("should generate a different PIN when full name is changed",function(a){e.fullName=n.substring(4),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("3233",a)}),it("should generate a different PIN when domain is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.substring(1),expect(e.generatePassword(t)).toBeResolvedWith("5600",a)}),afterEach(JasminePromiseMatchers.uninstall)}),describe("Test Six Digit Pin",function(){var e=new PassOff,a="684466",s="998384",t="pin-6",n="MrRobot",o="elliot",r="Evil Corp must die",i="fsociety.co.uk";beforeEach(JasminePromiseMatchers.install),it("should generate known PIN",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same PIN when case is changed for name",function(s){e.fullName=n.toUpperCase(),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same PIN when case is changed for user name",function(s){e.fullName=n,e.userName=o.toUpperCase(),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same PIN when case is changed for domain",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same PIN when domain starts with 'account.login.'",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="account.login."+i,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain has full URL",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="https://account.login."+i+"/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate a different PIN when case is changed for pass phrase",function(a){e.fullName=n,e.userName=o,e.passPhrase=r.toLowerCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("240985",a)}),it("should generate a different PIN when full name is changed",function(a){e.fullName=n.substring(1),e.userName=o,e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("886527",a)}),it("should generate a different PIN when user name is changed",function(a){e.fullName=n,e.userName=o.substring(2),e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("971333",a)}),it("should generate a different PIN when domain is changed",function(a){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.substring(3),expect(e.generatePassword(t)).toBeResolvedWith("212147",a)}),it("should generate known PIN without a user name",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same PIN when case is changed for name",function(a){e.fullName=n.toLowerCase(),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same PIN when case is changed for domain",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same PIN when domain starts with 'account.login.'",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="account.login."+i,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain has full URL",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="http://account.login."+i+"/intothebowels/downthere/wtf.html",expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate a different PIN when case is changed for pass phrase",function(a){e.fullName=n,e.userName="",e.passPhrase=r.toUpperCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("053243",a)}),it("should generate a different PIN when full name is changed",function(a){e.fullName=n.substring(4),e.userName="",e.passPhrase=r,e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("446552",a)}),it("should generate a different PIN when domain is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.substring(1),expect(e.generatePassword(t)).toBeResolvedWith("767092",a)}),afterEach(JasminePromiseMatchers.uninstall)}),describe("Test User Name",function(){var e=new PassOff,a="fixyijata",s="login",t="HumptyDumpty",n="",o="I sat on the wall and had a GREAT fall",r="nurseryrhymes.com.au";beforeEach(JasminePromiseMatchers.install),it("should generate known user name",function(i){e.fullName=t,e.userName=n,e.passPhrase=o,e.domainName=r,expect(e.generatePassword(s)).toBeResolvedWith(a,i)}),it("should generate same user name when case is changed for name",function(i){e.fullName=t.toUpperCase(),e.userName=n,e.passPhrase=o,e.domainName=r,expect(e.generatePassword(s)).toBeResolvedWith(a,i)}),it("should generate same user name when case is changed for domain",function(i){e.fullName=t,e.userName=n,e.passPhrase=o,e.domainName=r.toUpperCase(),expect(e.generatePassword(s)).toBeResolvedWith(a,i)}),it("should generate same user name when domain starts with 'wwwotherstuff.'",function(i){e.fullName=t,e.userName=n,e.passPhrase=o,e.domainName="wwwotherstuff."+r,expect(e.generatePassword(s)).toBeResolvedWith(a,i)}),it("should generate same password when domain has full URL",function(i){e.fullName=t,e.userName=n,e.passPhrase=o,e.domainName="https://wwwotherstuff."+r+"/wtf.html",expect(e.generatePassword(s)).toBeResolvedWith(a,i)}),it("should generate a different user name when case is changed for pass phrase",function(a){e.fullName=t,e.userName=n,e.passPhrase=o.toLowerCase(),e.domainName=r,expect(e.generatePassword(s)).toBeResolvedWith("sitteyeja",a)}),it("should generate a different user name when full name is changed",function(a){e.fullName=t.substring(1),e.userName=n,e.passPhrase=o,e.domainName=r,expect(e.generatePassword(s)).toBeResolvedWith("weykoqufo",a)}),it("should generate a different user name when domain is changed",function(a){e.fullName=t,e.userName=n,e.passPhrase=o,e.domainName=r.substring(3),expect(e.generatePassword(s)).toBeResolvedWith("gabhuziwe",a)}),afterEach(JasminePromiseMatchers.uninstall)}),describe("Test Security Answers",function(){var e=new PassOff,a="hu yifse ciq kujurba",s="ceh qisyezoda wolu",t="answer",n="KruderAndDorfmeister",o="kandd",r="Bugpowder dust",i="kanddsessions.cool",d="What is your mother's maiden name?";beforeEach(JasminePromiseMatchers.install),it("should generate known answer",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same answer when case is changed for name",function(s){e.fullName=n.toUpperCase(),e.userName=o,e.passPhrase=r,e.domainName=i,e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same answer when case is changed for user name",function(s){e.fullName=n,e.userName=o.toUpperCase(),e.passPhrase=r,e.domainName=i,e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same answer when case is changed for domain",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.securityQuestion=d,e.domainName=i.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same answer when domain starts with 'www.'",function(s){
e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="www."+i,e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same password when domain has full URL",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName="https://www."+i+"/wtf.html",e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same answer when question case is changed",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,e.securityQuestion=d.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same answer when question punctuation is changed",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,e.securityQuestion="'What' is your mothers maiden name",expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate same answer when question spacing is changed",function(s){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,e.securityQuestion="What  is your mother's maiden   name ?",expect(e.generatePassword(t)).toBeResolvedWith(a,s)}),it("should generate a different answer when case is changed for pass phrase",function(a){e.fullName=n,e.userName=o,e.passPhrase=r.toLowerCase(),e.domainName=i,expect(e.generatePassword(t)).toBeResolvedWith("lu lunlo piz zizovwu",a)}),it("should generate a different answer when full name is changed",function(a){e.fullName=n.substring(4),e.userName=o,e.passPhrase=r,e.domainName=i,e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith("mo paltu kib cazojbe",a)}),it("should generate a different answer when user name is changed",function(a){e.fullName=n,e.userName=o.substring(2),e.passPhrase=r,e.domainName=i,e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith("va sobsu qoj narixqe",a)}),it("should generate a different answer when domain is changed",function(a){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i.substring(3),e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith("qujl fav yenvoju gah",a)}),it("should generate a different answer when question is changed",function(a){e.fullName=n,e.userName=o,e.passPhrase=r,e.domainName=i,e.securityQuestion=d.substring(8),expect(e.generatePassword(t)).toBeResolvedWith("si culni tob lugorju",a)}),it("should generate known answer without a user name",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same answer when case is changed for name",function(a){e.fullName=n.toLowerCase(),e.userName="",e.passPhrase=r,e.domainName=i,e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same answer when case is changed for domain",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.toUpperCase(),e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same answer when domain starts with 'www.'",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="www."+i,e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same password when domain has full URL",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName="https://www."+i+"/wtf.html",e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same answer when question case is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,e.securityQuestion=d.toUpperCase(),expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same answer when question punctuation is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,e.securityQuestion="'What' is your mothers maiden name",expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate same answer when question spacing is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,e.securityQuestion="What  is your mother's maiden   name ?",expect(e.generatePassword(t)).toBeResolvedWith(s,a)}),it("should generate a different answer when case is changed for pass phrase",function(a){e.fullName=n,e.userName="",e.passPhrase=r.toUpperCase(),e.domainName=i,e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith("devk zap kuhsici ber",a)}),it("should generate a different answer when full name is changed",function(a){e.fullName=n.substring(4),e.userName="",e.passPhrase=r,e.domainName=i,e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith("dusb cir retzagi meq",a)}),it("should generate a different answer when domain is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i.substring(1),e.securityQuestion=d,expect(e.generatePassword(t)).toBeResolvedWith("tibr vut mufwuju yoz",a)}),it("should generate a different answer when question is changed",function(a){e.fullName=n,e.userName="",e.passPhrase=r,e.domainName=i,e.securityQuestion=d.substring(8),expect(e.generatePassword(t)).toBeResolvedWith("pucp zuy vopjova met",a)}),afterEach(JasminePromiseMatchers.uninstall)}),describe("Test Open Sesame Temporary Phrase Store",function(){var e,a;it("should fail when attempting to encrypt empty pass phrase",function(e){var a=new TemporaryPhraseStore;expect(a.encryptPhrase("","")).toBeRejected(e)}),it("should fail when attempting to decrypt empty encypted data",function(e){var a=new TemporaryPhraseStore;expect(a.decryptPhrase("Thr","JohnSmith")).toBeRejected(e)}),it("should successfully encrypt phrase and name",function(e){var a=new TemporaryPhraseStore;return a.encryptPhrase("A special pass phrase","JohnSmith").then(function(s){expect(s).toEqual("Success"),expect(a.encData).toBeDefined(),e()})}),it("should produce different encrypted data for the same phrase and name",function(s){var t=new TemporaryPhraseStore;t.encryptPhrase("A special pass phrase with some Punctuation!?","Jane Citizen").then(function(s){return e=t.encData.ciphertext,a=t.encData.iv,!0}).then(function(e){return t.encryptPhrase("A special pass phrase with some Punctuation!?","Jane Citizen")}).then(function(n){expect(t.encData.ciphertext).not.toEqual(e),expect(t.encData.iv).not.toEqual(a),s()})}),it("should successfully decrypt the phrase using the first three characters and name",function(e){var a=new TemporaryPhraseStore;a.encryptPhrase("aP2 with Some Special Stuff","KruderAndDorfmeister").then(function(s){expect(a.decryptPhrase("aP2","KruderAndDorfmeister")).toBeResolvedWith("aP2 with Some Special Stuff",e)})}),it("should successfully decrypt a phrase with special characters using the first three characters and name",function(e){var a=new TemporaryPhraseStore;a.encryptPhrase("Ihëart årt and £$¢!","HumptyDumpty").then(function(s){expect(a.decryptPhrase("Ihë","HumptyDumpty")).toBeResolvedWith("Ihëart årt and £$¢!",e)})}),it("should fail to decrypt the phrase using the first two characters and name",function(e){var a=new TemporaryPhraseStore;a.encryptPhrase("Here is a special [phrase]","MrRobot").then(function(s){expect(a.decryptPhrase("He","MrRobot")).toBeRejected(e)})}),it("should remove encrypted data after failing to decrypt the phrase using the first two characters and name",function(e){var a=new TemporaryPhraseStore;a.encryptPhrase("Here is a special [phrase]","MrRobot").then(function(e){return a.decryptPhrase("He","MrRobot")}).catch(function(s){expect(a.encData).not.toBeDefined(),e()})}),it("should fail to decrypt the phrase using the wrong case for the first three characters and name and encrypted data should be removed",function(e){var a=new TemporaryPhraseStore;a.encryptPhrase("This is a pass phrase","TylerDurden").then(function(s){expect(a.decryptPhrase("tHI","TylerDurden")).toBeRejected(e)})}),it("should remove encrypted data after failing to decrypt the phrase using the wrong case for the first three characters and name",function(e){var a=new TemporaryPhraseStore;a.encryptPhrase("This is a pass phrase","TylerDurden").then(function(e){return a.decryptPhrase("tHI","TylerDurden")}).catch(function(s){expect(a.encData).not.toBeDefined(),e()})}),it("should clear encrypted data and hash when the clearStore method is called",function(e){var a=new TemporaryPhraseStore;a.encryptPhrase("This is a pass phrase","TylerDurden").then(function(s){a.clearStore(),expect(a.encData).not.toBeDefined(),e()})}),it("should allow encrypted data and hash to be passed in and a succsefull decryption to occur",function(e){var a=new TemporaryPhraseStore,s=new TemporaryPhraseStore;a.encryptPhrase("This is a pass phrase","TylerDurden").then(function(t){s.storeValues(a.threeCharHash,a.encData),expect(s.decryptPhrase("Thi","TylerDurden")).toBeResolvedWith("This is a pass phrase",e)})})});